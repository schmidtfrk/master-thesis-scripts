from bsm_lib import *

#gauge-mix(3,3,1)
print(general_safe_bm([[1,1,1,1,1,1,0,0,0],[0,0,0,1,1,1,1,1,1],[0,1,0,0,1,0,0,0,0],[0,0,1,0,0,1,0,0,0],[1,1,1,0,0,0,0,0,0]],[[1,1,0,1,1,0,1,1,0],[0,1,1,0,1,1,0,1,1],[0,0,0,0,0,0,1,1,0],[0,0,0,0,0,0,1,0,1]],[1,0,0,1,0,0,1,0,0],#z-type
                [[1,1,0,1,1,0,1,1,0],[0,1,1,0,1,1,0,1,1],[0,0,0,0,0,0,1,1,0],[0,0,0,0,0,0,1,0,1],[1,0,0,1,0,0,1,0,0]],[[1,1,1,1,1,1,0,0,0],[0,0,0,1,1,1,1,1,1],[0,1,0,0,1,0,0,0,0],[0,0,1,0,0,1,0,0,0]],[1,1,1,0,0,0,0,0,0],#x-type
                ['x','x','x','x','x','x','z','z','z'])[0])
print(general_safe_bm_erasure([[1,1,1,1,1,1,0,0,0],[0,0,0,1,1,1,1,1,1],[0,1,0,0,1,0,0,0,0],[0,0,1,0,0,1,0,0,0],[1,1,1,0,0,0,0,0,0]],[[1,1,0,1,1,0,1,1,0],[0,1,1,0,1,1,0,1,1],[0,0,0,0,0,0,1,1,0],[0,0,0,0,0,0,1,0,1]],[1,0,0,1,0,0,1,0,0],#z-type
                [[1,1,0,1,1,0,1,1,0],[0,1,1,0,1,1,0,1,1],[0,0,0,0,0,0,1,1,0],[0,0,0,0,0,0,1,0,1],[1,0,0,1,0,0,1,0,0]],[[1,1,1,1,1,1,0,0,0],[0,0,0,1,1,1,1,1,1],[0,1,0,0,1,0,0,0,0],[0,0,1,0,0,1,0,0,0]],[1,1,1,0,0,0,0,0,0],#x-type
                ['x','x','x','x','x','x','z','z','z']))
#output:[896, 7296, 23808, 35328, 19200, 0, 0, 0, 0, 0]
print(general_safe_bm_erasure([[1,1,1,1,1,1,0,0,0],[0,0,0,1,1,1,1,1,1],[0,1,0,0,1,0,0,0,0],[0,0,1,0,0,1,0,0,0],[1,1,1,0,0,0,0,0,0]],[[1,1,0,1,1,0,1,1,0],[0,1,1,0,1,1,0,1,1],[0,0,0,0,0,0,1,1,0],[0,0,0,0,0,0,1,0,1]],[1,0,0,1,0,0,1,0,0],#z-type
                [[1,1,0,1,1,0,1,1,0],[0,1,1,0,1,1,0,1,1],[0,0,0,0,0,0,1,1,0],[0,0,0,0,0,0,1,0,1],[1,0,0,1,0,0,1,0,0]],[[1,1,1,1,1,1,0,0,0],[0,0,0,1,1,1,1,1,1],[0,1,0,0,1,0,0,0,0],[0,0,1,0,0,1,0,0,0]],[1,1,1,0,0,0,0,0,0],#x-type
                ['x','x','x','x','x','x','z','z','z']))

#calculating the efficiency of gauge-mix(3,3,1) without linear optics
print(erasure([[1,1,0,1,1,0,1,1,0],[0,1,1,0,1,1,0,1,1],[0,0,0,0,0,0,1,1,0],[0,0,0,0,0,0,1,0,1]],[1,0,0,1,0,0,1,0,0],[[1,1,1,1,1,1,0,0,0],[0,0,0,1,1,1,1,1,1],[0,1,0,0,1,0,0,0,0],[0,0,1,0,0,1,0,0,0]],[1,1,1,0,0,0,0,0,0]))
